# 管理ユーザー向けガイド

各テナントの**管理ユーザー**（運営担当者）向けに、管理画面の使い方・サービス全体の構造・セキュリティ方針をまとめています。

---

## 1. 管理画面の使い方

### 1.1 ログイン

1. **管理画面のURLにアクセスする**
   - **従来の単一運用**の場合: `https://<あなたのドメイン>/admin/login`
   - **テナント運用**の場合: 例として WHGC セミナーなら `https://<あなたのドメイン>/admin/login?tenant=whgc-seminars`  
     または、テナント用管理トップ `https://<あなたのドメイン>/whgc-seminars/admin` にアクセスするとログイン画面に誘導されます。

2. **テナントを選択する**（テナント運用時）
   - ログイン画面で「テナント」から、自分が管理するテナント（例: WHGC セミナー）を選択します。

3. **パスワードを入力してログイン**
   - 設定されている管理用パスワードを入力し、「ログイン」をクリックします。
   - ログインに成功すると、そのテナントの管理トップ（実施一覧または予約一覧）に移動します。

**注意**: 管理画面は**テナントごと**に分かれており、ログインしたテナントのデータだけが表示・操作対象になります。他テナントのデータは操作できません。

---

### 1.2 メニュー構成

管理画面の左サイドバーから、次のメニューにアクセスできます。

| メニュー | 説明 |
|----------|------|
| **実施一覧** | 過去に実施したセミナーの数と、総登録者数の統計を表示します。 |
| **予約一覧** | セミナー一覧の表示・選択、各セミナーの予約者一覧の確認・ステータス変更・キャンセル、およびセミナーの新規作成・編集・画像登録ができます。 |
| **会員企業ドメイン** | 会員限定セミナーで「会員」とみなすメールドメイン（例: `example.co.jp`）の追加・削除をします。 |
| **アンケート結果** | セミナーを選択し、事前アンケート・事後アンケートの回答結果を閲覧します。 |

画面下部の「公開サイトへ →」から、参加者向けのセミナー一覧ページに移動できます。

---

### 1.3 実施一覧（ダッシュボード）

- **実施済みセミナー数**: 開催日が過去のセミナーの件数です。
- **実施済みの総登録者数**: それらのセミナーへの予約者数の合計です。
- 実施済みセミナーごとの一覧（セミナー名・開催日・登録者数など）が表示されます。

実施一覧は参照用です。予約の変更やセミナーの編集は「予約一覧」から行います。

---

### 1.4 予約一覧（メインの作業画面）

予約一覧では、**セミナー単位**で予約を確認・操作し、あわせてセミナーの新規作成・編集・画像登録も行います。

#### セミナー一覧の表示

- 画面上部でセミナーが一覧表示されます（開催日順など）。
- セミナーを**選択**すると、そのセミナーの予約者一覧が下に表示されます。

#### 予約者一覧での操作

- **予約者一覧**: 選択したセミナーの予約者（氏名・メール・会社名・予約番号・ステータスなど）が表で表示されます。
- **ステータス変更**: 必要に応じて、予約のステータスを変更できます。
- **キャンセル**: 予約をキャンセルすると、予約者にキャンセル通知メールが送信されます（設定されている場合）。
- **公開サイトのリンク**: 各セミナーの詳細ページ・予約フォームへのリンクを開けます。

#### セミナーの新規作成・編集・画像

- **新規作成**: 「セミナーを新規作成」から、新しいセミナーを追加します。タイトル・説明・開催日時・定員・開催形式・対象（会員限定／一般公開）・招待コードなどを入力します。
- **編集**: 一覧の「編集」から、既存セミナーの内容を変更します。
- **画像登録**: 一覧の「画像」から、セミナーのヒーロー画像をアップロード・変更します。対応形式は JPEG / PNG / GIF / WebP です。

---

### 1.5 会員企業ドメイン

- **会員限定セミナー**では、登録したドメインのメールアドレス（例: `user@example.co.jp`）を持つ方を「会員」として扱います。
- **追加**: 「ドメイン」に `@` より後ろの部分（例: `example.co.jp`）を入力して追加します。
- **削除**: 一覧の削除ボタンで、不要なドメインを削除できます。
- 会員以外の方が会員限定セミナーに申し込む場合は、**招待コード**が正しければ申し込み可能です（招待コードはセミナー編集画面で設定します）。

---

### 1.6 アンケート結果

- **セミナーを選択**すると、そのセミナーの**事前アンケート**と**事後アンケート**の回答結果が表示されます。
- タブで「事前」「事後」を切り替えて閲覧します。
- 回答内容は表形式で確認できます。設問の変更や集計のエクスポートは、現状は管理画面外の手順が必要な場合があります。

---

### 1.7 テナント運用時の注意

- ログイン時に選択した**テナント**のデータだけが表示されます。
- 管理画面のURL（例: `/whgc-seminars/admin`）と、ログインしているテナントが一致している必要があります。URLを他テナントのものに変えても、他テナントのデータは操作できません（セキュリティ上、他テナントにはアクセス不可です）。

---

## 2. 全体のサービス構造

### 2.1 参加者（申込者）向けの流れ

1. **公開サイト**でセミナー一覧・詳細を閲覧する。
2. **予約フォーム**で氏名・メール・会社名などを入力して申し込む。
3. **予約完了**後、メールで予約番号・参加URL（Google Meet 等）・変更・キャンセル用リンクを受け取る。
4. 必要に応じて、メールのリンクから**予約の変更・キャンセル**を行う（予約番号を入力して本人確認）。
5. **事前アンケート**・**事後アンケート**のリンクから回答する（任意）。

### 2.2 管理者（あなた）向けの流れ

1. **管理画面**にログインする（テナント選択＋パスワード）。
2. **予約一覧**でセミナーを選び、予約者の確認・ステータス変更・キャンセルを行う。
3. **セミナーの新規作成・編集・画像登録**で、公開される内容を管理する。
4. **会員企業ドメイン**で、会員限定セミナーの対象ドメインを管理する。
5. **アンケート結果**で、事前・事後アンケートの回答を確認する。

### 2.3 データの置き場所（イメージ）

- **セミナー一覧・会員ドメイン・予約番号インデックス**: あなたのテナント用の「予約管理マスター」スプレッドシートで管理されています。
- **各セミナーの予約者・アンケート回答**: セミナーごとの「セミナー用スプレッドシート」に保存されています。
- **セミナー画像**: Google Drive の指定フォルダに保存され、公開ページで表示されます。
- **メール送信**: 予約完了・キャンセル通知などは、Resend を通じて送信されます（送信元・問い合わせ先はテナントごとに設定可能です）。

管理者が直接スプレッドシートや Drive を編集する必要はなく、**管理画面の操作だけで**上記の内容を運用できます。

---

## 3. セキュリティ方針

### 3.1 テナントの分離

- 本システムは**複数テナント**（例: WHGC セミナー、KGRI PIC センターなど）を同一の基盤で運用しています。
- **あなたがログインしたテナントのデータだけ**が表示・操作の対象です。
- 他テナントのセミナー・予約・会員ドメイン・アンケート結果には、管理画面からはアクセスできません。URLを変更しても他テナントのデータは表示されず、操作もできません。

### 3.2 管理画面の保護

- 管理画面は**パスワード**で保護されています。
- テナント運用時は、**どのテナントでログインしたか**が記録され、そのテナントの管理画面だけを利用できます。
- パスワードは第三者に教えず、**担当者だけが知る**ようにしてください。共有する必要がある場合は、限られた運営メンバーにのみ伝え、伝達は安全な方法で行ってください。

### 3.3 予約番号と本人確認

- 参加者が「予約の変更・キャンセル」を行うときは、メールに記載の**予約番号**の入力で本人確認をしています。
- 予約番号はテナント内で一意に割り当てられ、他テナントの予約には使えません。
- 予約番号や変更・キャンセル用リンクは、**予約者本人にのみ伝え**、第三者に共有しないよう案内してください。

### 3.4 メール送信について

- 予約完了・キャンセル通知などは、**送信専用**のメールアドレスから送信されます。
- メール本文には「このメールに返信されても対応できません。お問い合わせは○○まで」といった案内が含まれます。問い合わせ先はテナントごとに設定されています。
- 管理者は、問い合わせ先メールアドレスが正しく設定されているか、運用開始前に確認してください。

### 3.5 管理者が心がけること

| 項目 | 推奨 |
|------|------|
| パスワード | 推測されにくいものを使用し、定期的に変更を検討する。 |
| ログアウト | 共有のパソコンでは、作業後に必ずログアウトする（ブラウザを閉じるだけでは不十分な場合があります）。 |
| URLの共有 | 管理画面のURLや予約番号付きリンクを、不必要な相手に送らない。 |
| 問い合わせ先 | メールの問い合わせ先が、実際に確認できるアドレスになっているか確認する。 |

---

## 4. よくある質問（想定）

**Q. 他テナントのセミナーや予約を見たい**  
A. セキュリティ上、他テナントのデータにはアクセスできません。他テナントの運営担当者に問い合わせてください。

**Q. パスワードを忘れた**  
A. パスワードの再設定は、システム管理者（本システムの運用・設定を担当する方）に依頼してください。管理画面からは自分で再設定できません。

**Q. 予約番号がメールに表示されない／間違っている**  
A. 古い予約では、短い形式の予約番号が表示されていない場合があります。その場合はメールに記載の長いID（予約識別子）で変更・キャンセル画面に入力できる場合があります。表示の不具合が続く場合は、システム管理者に連絡してください。

**Q. セミナー画像を変更したが、公開サイトに反映されない**  
A. ブラウザのキャッシュの影響で、しばらく古い画像が表示されることがあります。しばらく経ってから再読み込みするか、シークレットウィンドウで確認してみてください。

---

以上が、管理ユーザー向けのガイドです。運用で不明な点は、システム管理者または各テナントの運営責任者にご相談ください。
